# Fst

Reading in Files and Converting to genlight for StAMPP
```{r}
library(StAMPP)
library(tidyverse)
RISG_genind <- vcfR2genind(read.vcfR("../Filtering/RISG.vcf"))
Samples <- read.table("../GeneticDiversity/Samples.txt", header = TRUE) %>% 
  mutate(Population = recode(Population, FI = 'CL1', NEH = 'CL2'))
poplist.names <- Samples$Population
strata(RISG_genind) <- Samples
setPop(RISG_genind) <- ~Population
RISG_genlight <- stamppConvert(RISG_genind, "genlight")
```

Doing Pairwise Fst
```{r}
RISG_Fst <- stamppFst(RISG_genlight, 10000, 95, 4)
```

```{r}
Fst <- RISG_Fst$Fsts
Pval <- RISG_Fst$Pvalues
```

Plotting Fst
```{r}
library(reshape2)
library(ggplot2)
Fst_melt <- melt(Fst, na.rm = TRUE)
Fst_plot <- ggplot(data = Fst_melt, aes(Var2, Var1, fill = value))+ 
  geom_tile()+
  scale_fill_distiller(palette = "RdYlBu")+
  xlab("")+
  ylab("")+
  geom_text(aes(label=format(round(value,2))))+
  ggtitle("Pairwise Fst Values")
plot(Fst_plot)
```

Saving Fsts to csv
```{r}
write.csv(RISG_Fst$Fsts, "Fst.csv")
write.csv(RISG_Fst$Pvalues, "Fst_Pvalues.csv")
```

