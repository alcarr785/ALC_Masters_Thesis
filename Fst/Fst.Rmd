# Fst

FST was calculated using the vcf file used for filtering.
Pairwise Fst and P-values were calculated using the R package StAMPP

First the vcf file was read into a genind file and populations were identified
```{r}
library(StAMPP)
library(tidyverse)
library(reshape2)
RISG_genind <- vcfR2genind(read.vcfR("../Filtering/RISG.vcf"))
Samples <- read.table("../GeneticDiversity/Samples.txt", header = TRUE) %>% 
  mutate(Population = recode(Population, FI = 'CL1', NEH = 'CL2'))
poplist.names <- Samples$Population
strata(RISG_genind) <- Samples
setPop(RISG_genind) <- ~Population
RISG_genlight <- stamppConvert(RISG_genind, "genlight")
```

Pairwise Fst was calulated using the following parameters:
Number of Bootstraps: 10,000\
Confidence Interval: 95%\
```{r}
RISG_Fst <- stamppFst(RISG_genlight, 10000, 95, 4)
```
StAMPP created two matrices, one for pairwise Fst and one for P-values
```{r}
Fst <- RISG_Fst$Fsts
Pval <- RISG_Fst$Pvalues
```

Here we plot the Fst matrix using a heatmap
```{r}
Fst_melt <- melt(Fst, na.rm = TRUE)
Fst_plot <- ggplot(data = Fst_melt, aes(Var2, Var1, fill = value))+ 
  geom_tile()+
  scale_fill_distiller(palette = "RdYlBu")+
  xlab("")+
  ylab("")+
  geom_text(aes(label=format(round(value,2))))+
  ggtitle("Pairwise Fst Values")
plot(Fst_plot)
```

