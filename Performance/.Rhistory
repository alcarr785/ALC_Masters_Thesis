SurvPopandSite2023 <- survreg(Surv(Age, Status) ~ Population+Site, data = Surv_2023, dist = "weibull")
SurvPopxSite2023 <- survreg(Surv(Age, Status) ~ Population*Site, data = Surv_2023, dist = "weibull")
NIN_survmod <- survreg(Surv(Age, Status) ~ Population, data = NIN_Surv, dist = "weibull")
WIC_survmod <- survreg(Surv(Age, Status) ~ Population, data = WIC_Surv, dist = "weibull")
summary(SurvPopxSite2023)
anova(SurvPopandSite2023, SurvPopxSite2023)
library(lme4)
PopandSite <- lmer(log(Length) ~ 1+Population+(1|Bag)+(1|Site), data = All_data)
PopxSite <- lmer(log(Length) ~ 1+Population+(1|Bag)+(1|Site)+1(Site:Population), data = All_data)
PopandSite <- lmer(log(Length) ~ 1+Population+(1|Bag)+(1|Site), data = All_data)
PopxSite <- lmer(log(Length) ~ 1+Population+(1|Bag)+(1|Site)+(1|Site:Population), data = All_data)
summary(PopxSite)
anova(PopandSite, PopxSite)
View(Data_2023)
anova(Lenth ~ Population, data = Data_2023)
aov(Length ~ Population, data = Data_2023)
summary(aov(Length ~ Population, data = Data_2023))
summary(NIN_Size)
summary(WIC_Size)
summary(aov(Length ~ Site, data = Data_2023))
WIC_Surv <- read.csv("WIC_Survival_Total.csv")
NIN_Surv <- read.csv("NIN_Survival_Total.csv")
NIN_Surv_Plot <- ggplot(NIN_Surv, aes(x=Population, y=Percent.Survival*100, fill=Type))+
geom_boxplot()+
ggtitle("Percent Survival (Ninigret)") +
ylab("Percent Survival (%)")+
ylim(0,100)
library(tidyverse)
library(cowplot)
WIC_Surv <- read.csv("WIC_Survival_Total.csv")
NIN_Surv <- read.csv("NIN_Survival_Total.csv")
NIN_Surv_Plot <- ggplot(NIN_Surv, aes(x=Population, y=Percent.Survival*100, fill=Type))+
geom_boxplot()+
ggtitle("Percent Survival (Ninigret)") +
ylab("Percent Survival (%)")+
ylim(0,100)
WIC_Surv_Plot <- ggplot(WIC_Surv, aes(x=Population, y=Percent.Survival*100, fill=Type))+
geom_boxplot()+
ggtitle("Percent Survival (Wickford)") +
ylab("Percent Survival (%)")+
ylim(0,100)
plot_grid(NIN_Surv_Plot, WIC_Surv_Plot, labels =c("A","B"), nrow = 1, ncol =2)
plot_grid(NIN_Surv_Plot, WIC_Surv_Plot, labels =c("A","B"), nrow = 1, ncol =2)
NIN_Yield <- subset(Yield, Site == "Ninigret")
WIC_Yield <- subset(Yield, Site == "Wickford")
NIN_Yield_Plot <- ggplot(NIN_Yield, aes(x=Population, y=Yield, fill=Type))+
geom_boxplot()+
ggtitle("Yield (Ninigret)") +
ylab("Yield (mm)")+
ylim(0,20000)
WIC_Yield_Plot <- ggplot(WIC_Yield, aes(x=Population, y=Yield, fill=Type))+
geom_boxplot()+
ggtitle("Yield (Wickford)") +
ylab("Yield (%)")+
ylim(0,120000)
plot_grid(NIN_Yield_Plot, WIC_Yield_Plot, labels = c("A", "B"), nrow = 1, ncol =2)
NIN_Yield <- subset(Yield, Site == "Ninigret")
WIC_Yield <- subset(Yield, Site == "Wickford")
NIN_Yield_Plot <- ggplot(NIN_Yield, aes(x=Population, y=Yield, fill=Type))+
geom_boxplot()+
ggtitle("Yield (Ninigret)") +
ylab("Yield (mm)")+
ylim(0,20000)
WIC_Yield_Plot <- ggplot(WIC_Yield, aes(x=Population, y=Yield, fill=Type))+
geom_boxplot()+
ggtitle("Yield (Wickford)") +
ylab("Yield (%)")+
ylim(0,20000)
plot_grid(NIN_Yield_Plot, WIC_Yield_Plot, labels = c("A", "B"), nrow = 1, ncol =2)
NIN_Yield <- subset(Yield, Site == "Ninigret")
WIC_Yield <- subset(Yield, Site == "Wickford")
NIN_Yield_Plot <- ggplot(NIN_Yield, aes(x=Population, y=Yield, fill=Type))+
geom_boxplot()+
ggtitle("Yield (Ninigret)") +
ylab("Yield (mm)")+
ylim(0,20000)
WIC_Yield_Plot <- ggplot(WIC_Yield, aes(x=Population, y=Yield, fill=Type))+
geom_boxplot()+
ggtitle("Yield (Wickford)") +
ylab("Yield (mm)")+
ylim(0,20000)
plot_grid(NIN_Yield_Plot, WIC_Yield_Plot, labels = c("A", "B"), nrow = 1, ncol =2)
plot_grid(NIN_Yield_Plot, WIC_Yield_Plot, labels = c("A", "B"), nrow = 1, ncol =2)
plot_grid(NIN_Surv_Plot, WIC_Surv_Plot, labels =c("A","B"), nrow = 2, ncol = 1)
plot_grid(NIN_Yield_Plot, WIC_Yield_Plot, labels = c("A", "B"), nrow = 2, ncol =1)
PopandSite <- lmer(log(Length) ~ 1+Population+(1|Bag)+(1|Site), data = All_data)
library(lme4)
PopandSite <- lmer(log(Length) ~ 1+Population+(1|Bag)+(1|Site), data = All_data)
PopxSite <- lmer(log(Length) ~ 1+Population+(1|Bag)+(1|Site)+(1|Site:Population), data = All_data)
summary(PopxSite)
anova(PopandSite, PopxSite)
PopxSite2023 <- lmer(log(Length) ~ 1+Population+(1|Bag)+(1|Site)+(1|Site:Population), data = Data_2023)
PopandSite2023 <- lmer(log(Length) ~ 1+Population+(1|Bag)+(1|Site), data = Data_2023)
anova(PopandSite2023, PopxSite2023)
View(Site_Avg_Surv)
View(Site_Avg_Size)
View(PopxSite2023)
plot_grid(NIN_plot, WIC_plot, labels = c("A", "B"), nrow = 1, ncol =2)
plot_grid(NIN_plot, WIC_plot, labels = c("A", "B"), nrow = 2, ncol =1)
kruskall.test(Length ~ Population, data = NIN_Size)
kruskal.test(Length ~ Population, data = NIN_Size)
kruskal.test(Length ~ Line, data = NIN_Size)
library(dunn.test)
dunn.test(Length ~ Line, data = NIN_Size)
dunn.test(x=NIN_Size$Length, g=NIN_Size$Line, method = "bonerroni")
dunn.test(x=NIN_Size$Length, g=NIN_Size$Line, method = "bonferroni")
dunn.test(x=WIC_Size$Length, g=WIC_Size$Line, method = "bonferroni")
wilcox.test(Length ~ Site, data = Data_2023)
View(Avg_Yield)
ggplot(Avg_Yield, aes(x=reorder(Site_Yield), y=Pop_Yield, shape = Population, color = Type))+
q()
Year1_Size <- read.csv("Year1.csv") %>%
filter(Bag != "1" | Population != "GH") %>%
group_by(Population, Bag) %>%
mutate(Unsellable = ifelse(Length < 40, 1, 0))%>%
mutate(Length = ifelse(Length < 40, NA, Length)) %>%
summarize(Avg_Size = mean((Length), na.rm = TRUE), Survived = n(), Unsellable = sum(Unsellable)) %>%
mutate(Total = 55)
library(tidyverse)
Year1_Size <- read.csv("Year1.csv") %>%
filter(Bag != "1" | Population != "GH") %>%
group_by(Population, Bag) %>%
mutate(Unsellable = ifelse(Length < 40, 1, 0))%>%
mutate(Length = ifelse(Length < 40, NA, Length)) %>%
summarize(Avg_Size = mean((Length), na.rm = TRUE), Survived = n(), Unsellable = sum(Unsellable)) %>%
mutate(Total = 55)
Year1_Yield <- Year1_Size %>%
mutate(Sellable = Survived-Unsellable) %>%
mutate(Percent_Sellable = Sellable/Total) %>%
mutate(Type = ifelse((Population == "CL2" | Population =="CL1"), "Commercial", "Wild")) %>%
mutate(Population = factor(Population, levels = c("CL1", "CL2", "GH", "MV", "CT", "NR"))) %>%
mutate(Yield = Percent_Sellable*Avg_Size*500)
Year1_Yield_Avg <- Year1_Yield %>%
group_by(Population) %>%
summarize(Avg_Yield = mean(Yield))
Yield_Survival <- rbind(read.csv("RWU_Survival_Total.csv"), read.csv("WIC_Survival_Total.csv"), read.csv("NIN_Survival_Total.csv"))
Yield_Size <- read.csv("All_Size.csv") %>%
filter(Bag != "1" | Population != "GH"| Site  != "RWU") %>%
mutate(Unsellable = ifelse(Length < 40, 1, 0)) %>%
mutate(Length = ifelse(Length < 40, NA, Length)) %>%
group_by(Population, Bag, Site) %>%
summarize(Unsellable = sum(Unsellable), Avg_size = mean((Length), na.rm = TRUE))
Yield <- merge(Yield_Survival, Yield_Size, by= c("Population", "Site", "Bag")) %>%
mutate(Avg_size = ifelse(Avg_size == "NaN", 0, Avg_size)) %>%
mutate(Sellable = Survived-Unsellable) %>%
mutate(Percent_Sellable = Sellable/Total) %>%
mutate(Yield = Percent_Sellable*Avg_size*500)
Avg_Yield <- Yield %>%
group_by(Population, Site) %>%
summarize(Pop_Yield = mean(Yield)) %>%
group_by(Site) %>%
mutate(Site_Yield = mean(Pop_Yield)) %>%
mutate(Type = ifelse((Population == "GH" | Population =="MV"), "Wild", "Commercial"))
ggplot(Avg_Yield, aes(x=Site_Yield, y=Pop_Yield, shape = Population, color = Type))+
geom_point()+
geom_smooth(method=lm, se = FALSE)
Year1_Yield_Plot <- ggplot(Year1_Yield, aes(x=Population, y=Yield, fill=Type))+
geom_boxplot()+
ggtitle("Yield (RWU)") +
ylab("Yield (mm)")
plot(Year1_Yield_Plot)
plot(Year1_plot)
NIN_Size <- read.csv("NIN_End.csv")%>%
select(Line, Bag.Number, Oyster.Number, Length) %>%
mutate(Type = ifelse(Line == "CL1" | Line == "CL2", "Commercial", "Wild")) %>%
filter(!is.na(Length)) %>%
rename(Bag = Bag.Number, Oyster = Oyster.Number) %>%
mutate(Bag = as.factor(Bag)) %>%
mutate(Oyster = as.factor(Oyster)) %>%
group_by(Line, Bag) %>%
mutate(Site = "Ninigret") %>%
mutate(Year = "2023")
WIC_Size <- read.csv("WIC_End.csv")%>%
select(Line, Bag.., Oyster.., Length) %>%
mutate(Type = ifelse(Line == "CL1" | Line == "CL2", "Commercial", "Wild")) %>%
filter(!is.na(Length)) %>%
rename(Bag = Bag.., Oyster = Oyster..) %>%
mutate(Bag = as.factor(Bag)) %>%
mutate(Oyster = as.factor(Oyster)) %>%
group_by(Line, Bag) %>%
mutate(Site = "Wickford") %>%
mutate(Year = "2023")
Year1 <- read.csv("RWU.csv") %>%
#Renaming commercial lines to keep them anonymous
mutate(Line = recode(Line, FI="CL1", NEH="CL2")) %>%
#Fixing a mistake in the sheet where lineage was accidentally entered as "Mv" instead of "MV"
mutate(Line = recode(Line, Mv="MV")) %>%
#Keeping only oysters recored at the end of the study.
filter(Date == "19-Oct-22") %>%
#Removing oysters with missing tags
filter(Pit.Tag.End.Num != "no tag") %>%
filter(!is.na(Length)) %>%
#Keeping only relevant information
select(Date, Line, Length, Bag.Number, Status, Pit.Tag.End.Num) %>%
#Defining oysters as either wild or commercial
mutate(Type = ifelse(Line == "CL1" | Line == "CL2", "Commercial", "Wild")) %>%
mutate(Bag = as.factor(Bag.Number)) %>%
mutate(Oyster = Pit.Tag.End.Num) %>%
mutate(Survived = ifelse(Status == "Alive" | Status == "alive" | Status =="alive, no pic", 1, 0)) %>%
mutate(Survived = as.numeric(Survived)) %>%
mutate(Length = as.numeric(Length)) %>%
mutate(Population = factor(Population, levels = c("CL1", "CL2", "GH", "MV", "CT", "NR"))) %>%
filter(!is.na(Length)) %>%
filter(Survived != 0) %>%
mutate(Year = "2022") %>%
mutate(Site = "RWU") %>%
select(Line, Bag, Oyster, Length, Type, Site, Year)
NIN_Size <- read.csv("NIN_End.csv")%>%
select(Line, Bag.Number, Oyster.Number, Length) %>%
mutate(Type = ifelse(Line == "CL1" | Line == "CL2", "Commercial", "Wild")) %>%
filter(!is.na(Length)) %>%
rename(Bag = Bag.Number, Oyster = Oyster.Number) %>%
mutate(Bag = as.factor(Bag)) %>%
mutate(Oyster = as.factor(Oyster)) %>%
group_by(Line, Bag) %>%
mutate(Site = "Ninigret") %>%
mutate(Year = "2023")
WIC_Size <- read.csv("WIC_End.csv")%>%
select(Line, Bag.., Oyster.., Length) %>%
mutate(Type = ifelse(Line == "CL1" | Line == "CL2", "Commercial", "Wild")) %>%
filter(!is.na(Length)) %>%
rename(Bag = Bag.., Oyster = Oyster..) %>%
mutate(Bag = as.factor(Bag)) %>%
mutate(Oyster = as.factor(Oyster)) %>%
group_by(Line, Bag) %>%
mutate(Site = "Wickford") %>%
mutate(Year = "2023")
Year1 <- read.csv("RWU.csv") %>%
#Renaming commercial lines to keep them anonymous
mutate(Line = recode(Line, FI="CL1", NEH="CL2")) %>%
#Fixing a mistake in the sheet where lineage was accidentally entered as "Mv" instead of "MV"
mutate(Line = recode(Line, Mv="MV")) %>%
#Keeping only oysters recored at the end of the study.
filter(Date == "19-Oct-22") %>%
#Removing oysters with missing tags
filter(Pit.Tag.End.Num != "no tag") %>%
filter(!is.na(Length)) %>%
#Keeping only relevant information
select(Date, Line, Length, Bag.Number, Status, Pit.Tag.End.Num) %>%
#Defining oysters as either wild or commercial
mutate(Type = ifelse(Line == "CL1" | Line == "CL2", "Commercial", "Wild")) %>%
mutate(Bag = as.factor(Bag.Number)) %>%
mutate(Oyster = Pit.Tag.End.Num) %>%
mutate(Survived = ifelse(Status == "Alive" | Status == "alive" | Status =="alive, no pic", 1, 0)) %>%
mutate(Survived = as.numeric(Survived)) %>%
mutate(Length = as.numeric(Length)) %>%
mutate(Line = factor(Line, levels = c("CL1", "CL2", "GH", "MV", "CT", "NR"))) %>%
filter(!is.na(Length)) %>%
filter(Survived != 0) %>%
mutate(Year = "2022") %>%
mutate(Site = "RWU") %>%
select(Line, Bag, Oyster, Length, Type, Site, Year)
RWU_Size <- Year1  %>%
filter(Line != "NR") %>%
filter(Line != "CT")
All_data <- rbind(NIN_Size, RWU_Size, WIC_Size) %>% rename(Population = Line)
Data_2023 <- rbind(NIN_Size, WIC_Size) %>% rename(Population = Line)
RWU_plot <- ggplot(RWU_Size, aes(x=Line, y=Length, fill = Type))+
geom_boxplot()+
labs(x = "Populations", y="Size (mm)")+
ggtitle("Oyster Size (RWU)")+
ylim(0,100)
NIN_plot <- ggplot(NIN_Size, aes(x=Line, y=Length, fill = Type))+
geom_boxplot()+
labs(x = "Populations", y="Size (mm)")+
ggtitle("Oyster Size (Ninigret)")+
ylim(0,100)
WIC_plot <- ggplot(WIC_Size, aes(x=Line, y=Length, fill = Type))+
geom_boxplot()+
labs(x = "Populations", y="Size (mm)")+
ggtitle("Oyster Size (Wickford)")+
ylim(0,100)
Year1_plot <- ggplot(Year1, aes(x=Line, y=Length, fill = Type))+
geom_boxplot()+
labs(x = "Population", y="Size (mm)")+
ggtitle("Oyster Size (RWU)")+
ylim(0,100)
plot_grid(NIN_plot, WIC_plot, labels = c("A", "B"), nrow = 1, ncol =2)
plot(Year1_plot)
Site_Avg_Surv <- rbind(read.csv("RWU_Survival_Total.csv"), read.csv("WIC_Survival_Total.csv"), read.csv("NIN_Survival_Total.csv")) %>%
group_by(Population, Site) %>%
summarize(Pop_Surv = mean(Percent.Survival)) %>%
group_by(Site) %>%
mutate(Site_Surv = mean(Pop_Surv)) %>%
mutate(Population = factor(Population, levels = c("CL1", "CL2", "GH", "MV", "CT", "NR"))) %>%
mutate(Type = ifelse((Population == "GH" | Population =="MV"), "Wild", "Commercial"))
ggplot(Site_Avg_Surv, aes(x=Site_Surv, y=Pop_Surv, shape = Population, color = Type))+
geom_point()+
geom_smooth(method=lm, se = FALSE)
WIC_Surv <- read.csv("WIC_Survival_Total.csv")
NIN_Surv <- read.csv("NIN_Survival_Total.csv")
NIN_Surv_Plot <- ggplot(NIN_Surv, aes(x=Population, y=Percent.Survival*100, fill=Type))+
geom_boxplot()+
ggtitle("Percent Survival (Ninigret)") +
ylab("Percent Survival (%)")+
ylim(0,100)
WIC_Surv_Plot <- ggplot(WIC_Surv, aes(x=Population, y=Percent.Survival*100, fill=Type))+
geom_boxplot()+
ggtitle("Percent Survival (Wickford)") +
ylab("Percent Survival (%)")+
ylim(0,100)
plot_grid(NIN_Surv_Plot, WIC_Surv_Plot, labels =c("A","B"), nrow = 1, ncol =2)
Year1_Surv_Plot <- ggplot(Year1_Survival, aes(x=Population, y=Percent.Survival*100, fill=Type))+
geom_boxplot()+
ggtitle("Percent Survival (RWU)") +
ylab("Percent Survival (%)")
plot(Year1_Surv_Plot)
WIC_Surv <- read.csv("WIC_Survival.csv")
NIN_Surv <- read.csv("NIN_Survival.csv")
Y1_Surv <- read.csv("RWU_Survival.csv") %>%
mutate(Population = factor(Population, levels = c("CL1", "CL2", "GH", "MV", "CT", "NR")))
RWU_Surv <- Y1_Surv %>%
filter(Population != "CT") %>%
filter(Population != "NR")
All_Surv <- rbind(WIC_Surv, NIN_Surv, RWU_Surv)
Surv_2023 <- rbind(WIC_Surv, NIN_Surv)
Site_Avg_Surv <- rbind(read.csv("RWU_Survival_Total.csv"), read.csv("WIC_Survival_Total.csv"), read.csv("NIN_Survival_Total.csv")) %>%
group_by(Population, Site) %>%
summarize(Pop_Surv = mean(Percent.Survival)) %>%
group_by(Site) %>%
mutate(Site_Surv = mean(Pop_Surv)) %>%
mutate(Type = ifelse((Population == "GH" | Population =="MV"), "Wild", "Commercial"))
ggplot(Site_Avg_Surv, aes(x=Site_Surv, y=Pop_Surv, shape = Population, color = Type))+
geom_point()+
geom_smooth(method=lm, se = FALSE)
Year1_Surv_Plot <- ggplot(Year1_Survival, aes(x=Population, y=Percent.Survival*100, fill=Type))+
geom_boxplot()+
ggtitle("Percent Survival (RWU)") +
ylab("Percent Survival (%)")
plot(Year1_Surv_Plot)
Year1_Surv_Plot <- ggplot(Year1_Survival, aes(x=Population, y=Percent.Survival*100, fill=Type))+
geom_boxplot()+
ggtitle("Percent Survival (RWU)") +
ylab("Percent Survival (%)")
View(Year1_Survival)
View(Year1_Survival)
Year1_Survival <- Year1_Survival %>% mutate(Population = factor(Population, levels = c("CL1", "CL2", "GH", "MV", "CT", "NR")))
Year1_Surv_Plot <- ggplot(Year1_Survival, aes(x=Population, y=Percent.Survival*100, fill=Type))+
geom_boxplot()+
ggtitle("Percent Survival (RWU)") +
ylab("Percent Survival (%)")
plot(Year1_Surv_Plot)
library(cowplot)
plot_grid(Year1_plot,NIN_plot,WIC_plot, Year1_Surv_Plot,NIN_Surv_Plot,WIC_Surv_Plot, labels = c("A","B","C","D","E","F", nrow = 2, ncol =3))
Year1_Surv_Plot <- ggplot(Year1_Survival, aes(x=Population, y=Percent.Survival*100, fill=Type))+
geom_boxplot()+
ylim(0,100)
ggtitle("Percent Survival (RWU)") +
ylab("Percent Survival (%)")
Year1_Surv_Plot <- ggplot(Year1_Survival, aes(x=Population, y=Percent.Survival*100, fill=Type))+
geom_boxplot()+
ylim(0,100)+
ggtitle("Percent Survival (RWU)") +
ylab("Percent Survival (%)")
plot_grid(Year1_plot,NIN_plot,WIC_plot, Year1_Surv_Plot,NIN_Surv_Plot,WIC_Surv_Plot, labels = c("A","B","C","D","E","F", nrow = 2, ncol =3))
plot_grid(Year1_plot,NIN_plot,WIC_plot, Year1_Surv_Plot,NIN_Surv_Plot,WIC_Surv_Plot,Year1_Yield_Plot,NIN_Yield_Plot,WIC_Yield_Plot, labels = c("A","B","C","D","E","F","G","H","I","J","K", nrow = 2, ncol =3))
plot_grid(Year1_plot,NIN_plot,WIC_plot, labels = c("A","B","C", nrow = 1, ncol =3))
plot_grid(Year1_plot,NIN_plot,WIC_plot, labels = c("A","B","C", nrow = 2, ncol =3))
plot_grid(Year1_plot,NIN_plot,WIC_plot, labels = c("A","B","C", nrow = 1, ncol =3))
plot_grid(Year1_plot,NIN_plot,WIC_plot, labels = c("A","B","C", nrow = 1, ncol =4))
plot_grid(Year1_plot,NIN_plot,WIC_plot, labels = c("A","B","C", nrow = 3, ncol =1))
plot_grid(Year1_plot,NIN_plot,WIC_plot, Year1_Surv_Plot,NIN_Surv_Plot,WIC_Surv_Plot,Year1_Yield_Plot,NIN_Yield_Plot,WIC_Yield_Plot, labels = c("A","B","C","D","E","F","G","H","I","J","K", nrow = 3, ncol =3))
plot_grid(Year1_plot,NIN_plot,WIC_plot, Year1_Surv_Plot,NIN_Surv_Plot,WIC_Surv_Plot,Year1_Yield_Plot,NIN_Yield_Plot,WIC_Yield_Plot, labels = c("A","B","C","D","E","F","G","H",nrow = 3, ncol =3))
plot_grid(Year1_plot,NIN_plot,WIC_plot, Year1_Surv_Plot,NIN_Surv_Plot,WIC_Surv_Plot,Year1_Yield_Plot,NIN_Yield_Plot,WIC_Yield_Plot, labels = c("A","B","C","D","E","F","G","H","I"), nrow = 3, ncol =3))
plot_grid(Year1_plot,NIN_plot,WIC_plot, Year1_Surv_Plot,NIN_Surv_Plot,WIC_Surv_Plot,Year1_Yield_Plot,NIN_Yield_Plot,WIC_Yield_Plot, labels = c("A","B","C","D","E","F","G","H","I"), nrow = 3, ncol =3)
plot_grid(Year1_plot,NIN_plot,WIC_plot, labels = c("A","B","C"), nrow = 3, ncol =3)
plot_grid(Year1_plot,NIN_plot,WIC_plot, labels = c("A","B","C"), nrow = 1, ncol =3)
plot_grid(Year1_Surv_Plot,NIN_Surv_Plot,WIC_Surv_Plot, labels = c("A","B","C"), nrow = 1, ncol =3)
plot_grid(Year1_Yield_Plot,NIN_Yield_Plot,WIC_Yield_Plot, labels = c("A","B","C"), nrow = 1, ncol =3)
library(lme4)
PopandSite <- lmer(log(Length) ~ 1+Population+(1|Bag)+(Site), data = All_data)
PopxSite <- lmer(log(Length) ~ 1+Population+(1|Bag)+(Site)+(1|Site:Population), data = All_data)
summary(PopxSite)
anova(PopandSite, PopxSite)
PopandSite <- lmer(log(Length) ~ 1+Population+(1|Bag)+(Site), data = All_data)
PopxSite <- lmer(log(Length) ~ 1+Population+(1|Bag)+(Site)+(1|Site:Population), data = All_data)
summary(PopxSite)
#anova(PopandSite, PopxSite)
summary(PopandSite)
View(PopxSite)
ggplot(Disease, aes(x= Lineage, y=Dermo.Intensity, fill = Type))+
geom_boxplot()+
ggtitle("Dermo Intensity at 19 Months")
library(tidyverse)
ggplot(Disease, aes(x= Lineage, y=Dermo.Intensity, fill = Type))+
geom_boxplot()+
ggtitle("Dermo Intensity at 19 Months")
#Reading in disease data
Disease <- read.csv("Disease2022.csv") %>% mutate(Lineage = recode(Lineage, FI="CL1", NEH="CL2")) %>%
mutate(Type = ifelse(Lineage == "CL1" | Lineage == "CL2", "Commercial", "Wild")) %>%
#Creating columns for disease prevalence
subset(Sample.ID != 'NR-209') %>%
group_by(Lineage, Type) %>%
mutate(Dermo_Infected = ifelse(Dermo.Intensity > 0, 1, 0)) %>%
mutate(MSX_Infected = ifelse(MSX.Intensity > 0, 1, 0)) %>%
mutate(SSO_Infected = ifelse(SSO.Intensity > 0, 1, 0))
ggplot(Disease, aes(x= Lineage, y=Dermo.Intensity, fill = Type))+
geom_boxplot()+
ggtitle("Dermo Intensity at 16 Months")+
xlab = "Population"
ggplot(Disease, aes(x= Lineage, y=Dermo.Intensity, fill = Type))+
geom_boxplot()+
ggtitle("Dermo Intensity at 16 Months")+
xlab("Population")
ggplot(Disease, aes(x= Lineage, y=MSX.Intensity, fill = Type))+
geom_boxplot()+
ylim(0,5)+
ggtitle("MSX Intensity at 19 Months")
ggplot(Disease, aes(x= Lineage, y=Dermo.Intensity, fill = Type))+
geom_boxplot()+
ggtitle("Dermo Intensity at 16 Months")+
xlab("Population")
ggplot(Disease, aes(x= Lineage, y=Dermo.Intensity, fill = Type))+
geom_boxplot()+
ggtitle("Dermo Intensity at 16 Months")+
xlab("Population")
ggplot(Disease, aes(x= Lineage, y=MSX.Intensity, fill = Type))+
geom_boxplot()+
ylim(0,5)+
ggtitle("MSX Intensity at 16 Months")+
xlab("Population")
ggplot(Disease, aes(x= Lineage, y=MSX.Intensity, fill = Type))+
geom_boxplot()+
ylim(0,5)+
ggtitle("MSX Intensity at 16 Months")+
xlab("Population")
ggplot(Disease, aes(x= Lineage, y=Dermo.Intensity, fill = Type))+
geom_boxplot()+
ggtitle("Dermo Intensity at 16 Months")+
xlab("Population")
MSX_Sum <- Disease %>% summarize(MSX_Avg = mean(MSX.Intensity))
View(MSX_Sum)
shapiro.test(Disease$Dermo_Infected)
kruskal.test(Disease$Dermo_Infected ~ Disease$Lineage)
shapiro.test(Disease$MSX_Infected)
kruskal.test(Disease$MSX_Infected ~ Disease$Lineage)
library(tidyverse)
library(survival)
library(survminer)
Surv2022 <- survreg(Surv(Age, Status) ~ Population, data = Y1_Surv, dist = "weibull")
summary(Surv2022)
Y1_data <- data.frame(Population = c("CL1","CL2","CT","GH","MV","NR"))
surv <- seq(.99, .01, by = -.01)
t1 <- predict(Surv2022, type = "quantile", p = 1 - surv, newdata = Y1_data)
Y1_wbmod <- cbind(Y1_data, t1) %>%
pivot_longer(names_to = "surv_id", values_to = "time", cols = -c(1:2)) %>%
mutate(
surv_id = as.factor(as.numeric(surv_id))) %>%
data.frame()
Y1_wbmod$surv = surv[as.numeric(Y1_wbmod$surv_id)]
Y1_wbmod$upper = NA
Y1_wbmod$lower = NA
Y1_wbmod$std.err = NA
Y1_wbmod$strata = NA
Y1_wbmod[, c("upper", "lower", "std.err", "strata")] <- NA
#Plotting probability of survival
ggsurvplot_df(Y1_wbmod, surv.geom = geom_line,
color = "Population", legend.title = NULL, legend = c("right"), title = "Survival Time",
break.time.by = 1)
ggsurvplot_df(Y1_wbmod, surv.geom = geom_line,
color = "Population", legend.title = NULL, legend = c("right"), title = "Survival Time",
break.time.by = 1)
View(Surv2022)
View(Y1_Surv)
PopandSite <- lmer(log(Length) ~ 1+Population+(1|Bag)+Site, data = All_data)
library(lme4)
PopandSite <- lmer(log(Length) ~ 1+Population+(1|Bag)+Site, data = All_data)
PopxSite <- lmer(log(Length) ~ 1+Population+(1|Bag)+Site+(1|Site:Population), data = All_data)
summary(PopxSite)
#anova(PopandSite, PopxSite)
PopandSite <- lmer(log(Length) ~ 1+Population+(1|Bag)+Site, data = All_data)
PopxSite <- lmer(log(Length) ~ 1+Population+(1|Bag)+Site+(1|Site:Population), data = All_data)
summary(PopxSite)
anova(PopandSite, PopxSite)
Year1Sum <- Year1 %>% summarize(SD = sd(Length))
library(tidyverse)
Year1Sum <- Year1 %>% summarize(SD = sd(Length))
View(Year1Sum)
Year1Sum <- Year1 %>% group_by(Population) %>% summarize(SD = sd(Length))
Year1Sum <- Year1 %>% group_by(Line) %>% summarize(SD = sd(Length))
library(tidyverse)
ggplot(Disease, aes(x= Lineage, y=Dermo.Intensity, fill = Type))+
geom_boxplot()+
ggtitle("Dermo Prevalence at 16 Months")+
xlab("Population")
ggplot(Disease, aes(x= Lineage, y=MSX.Intensity, fill = Type))+
geom_boxplot()+
ylim(0,5)+
ggtitle("MSX Prevalence at 16 Months")+
xlab("Population")
ggplot(Disease, aes(x= Lineage, y=Dermo.Intensity, fill = Type))+
geom_boxplot()+
ggtitle("Weighted Prevalence of Dermo at 16 Months")+
xlab("Population")+
ylab("Weighted Prevalence")
ggplot(Disease, aes(x= Lineage, y=MSX.Intensity, fill = Type))+
geom_boxplot()+
ylim(0,5)+
ggtitle("Weighted Prevalence of MSX at 16 Months")+
xlab("Population")+
ylab("Weighted Prevalence")
ggplot(Disease, aes(x= Lineage, y=Dermo.Intensity, fill = Type))+
geom_boxplot()+
ggtitle("Weighted Prevalence of Dermo at 16 Months")+
xlab("Population")+
ylab("Weighted Prevalence")
ggplot(Disease, aes(x= Lineage, y=MSX.Intensity, fill = Type))+
geom_boxplot()+
ylim(0,5)+
ggtitle("Weighted Prevalence of MSX at 16 Months")+
xlab("Population")+
ylab("Weighted Prevalence")
