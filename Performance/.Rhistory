write.csv(All_Surv, All.csv)
write.csv(All_Surv, "All.csv")
RWU_Bags <- read.csv("RWU.csv")
View(RWU_Bags)
RWU_Bags <- read.csv("RWU.csv") %>%
filter(Date == "19-Jul-21" | Date == "28-Jul-21")
library(tidyverse)
RWU_Bags <- read.csv("RWU.csv") %>%
filter(Date == "19-Jul-21" | Date == "28-Jul-21")
RWU_Alldata <- merge(RWU_Bags, RWU_Surv, by = Pit.Tag.End.Num)
RWU_Bags <- read.csv("RWU.csv") %>%
filter(Date == "19-Jul-21" | Date == "28-Jul-21") %>%
mutate(Pit.Tag.End.Num = Oyster)
RWU_Bags <- read.csv("RWU.csv") %>%
filter(Date == "19-Jul-21" | Date == "28-Jul-21") %>%
rename(Pit.Tag.End.Num = Oyster)
RWU_Bags <- read.csv("RWU.csv") %>%
filter(Date == "19-Jul-21" | Date == "28-Jul-21") %>%
rename(Oyster = Pit.Tag.End.Num)
RWU_Alldata <- merge(RWU_Bags, RWU_Surv, by = Oyster)
View(RWU_Bags)
View(RWU_Surv)
RWU_Bags <- read.csv("RWU.csv") %>%
filter(Date == "19-Jul-21" | Date == "28-Jul-21")
RWU_Alldata <- merge(RWU_Bags, RWU_Surv, by = Pit.Tag.End.Num)
RWU_Alldata <- merge(RWU_Bags, RWU_Surv, by = "Pit.Tag.End.Num")
View(RWU_Alldata)
write.csv(RWU_Alldata, "RWU_withbag.csv")
WIC_Surv <- read.csv("WIC_Survival.csv")
NIN_Surv <- read.csv("NIN_Survival.csv")
RWU_Surv <- read.csv("RWU_Survival.csv")
All_Surv <- rbind(WIC_Surv, NIN_Surv, RWU_Surv)
View(NIN_Surv)
WIC_Surv <- read.csv("WIC_Survival.csv")
NIN_Surv <- read.csv("NIN_Survival.csv")
RWU_Surv <- read.csv("RWU_Survival.csv")
All_Surv <- rbind(WIC_Surv, NIN_Surv, RWU_Surv)
Surv_2023 <- rbind(WIC_Surv, NIN_Surv)
SurvPop <- survreg(Surv(Age, Status) ~ Population, data = All_Surv, dist = "weibull")
library(tidyverse)
library(dplyr)
library(dunn.test)
library(ggplot2)
library(cowplot)
library(survival)
library(PAmeasures)
SurvPop <- survreg(Surv(Age, Status) ~ Population, data = All_Surv, dist = "weibull")
summary(SurvPop)
SurvSite <- survreg(Surv(Age, Status) ~ Site, data = All_Surv, dist = "weibull")
summary(SurvSite)
SurvPopandSite <- survreg(Surv(Age, Status) ~ Population+Site, data = All_Surv, dist = "weibull")
SurvPopxSite <- survreg(Surv(Age, Status) ~ Population*Site, data = All_Surv, dist = "weibull")
summary(SurvPopxSite)
fitted_values <- SurvPopxSite$linear.predictors
resids <- (log(SurvPopxSite$y[, 1]) - fitted_values) / SurvPopxSite$scale
resKM <- survfit(Surv(resids, Status) ~ 1, data = All_Surv)
plot(resKM, mark.time = FALSE, xlab = "AFT Residuals", ylab = "Survival Probability")
xx <- seq(min(resids), max(resids), length.out = 35)
yy <- exp(- exp(xx))
lines(xx, yy, col = "red", lwd = 2)
legend("bottomleft", c("KM estimate", "95% CI KM estimate",
"Survival function of Extreme Value distribution"),
lty = c(1,2,1), col = c(1,1,2), bty = "n")
p <- predict(SurvPopxSite, type = "response")
with(All_Surv, pam.censor(Age, p, Status))
anova(SurvPopandSite, SurvPopxSite)
SurvPop <- survreg(Surv(Age, Status) ~ Population, data = All_Surv, dist = "weibull")
summary(SurvPop)
SurvSite <- survreg(Surv(Age, Status) ~ Site, data = All_Surv, dist = "weibull")
summary(SurvSite)
SurvPopandSite <- survreg(Surv(Age, Status) ~ Population+Site, data = All_Surv, dist = "weibull")
SurvPopxSite <- survreg(Surv(Age, Status) ~ Population*Site, data = All_Surv, dist = "weibull")
summary(SurvPopxSite)
fitted_values <- SurvPopxSite$linear.predictors
resids <- (log(SurvPopxSite$y[, 1]) - fitted_values) / SurvPopxSite$scale
resKM <- survfit(Surv(resids, Status) ~ 1, data = All_Surv)
plot(resKM, mark.time = FALSE, xlab = "AFT Residuals", ylab = "Survival Probability")
xx <- seq(min(resids), max(resids), length.out = 35)
yy <- exp(- exp(xx))
lines(xx, yy, col = "red", lwd = 2)
legend("bottomleft", c("KM estimate", "95% CI KM estimate",
"Survival function of Extreme Value distribution"),
lty = c(1,2,1), col = c(1,1,2), bty = "n")
p <- predict(SurvPopxSite, type = "response")
with(All_Surv, pam.censor(Age, p, Status))
summary(anova(SurvPopandSite, SurvPopxSite))
summary(SurvPopxSite)
WIC_Surv <- read.csv("WIC_Survival.csv")
NIN_Surv <- read.csv("NIN_Survival.csv")
RWU_Surv <- read.csv("RWU_Survival.csv") %>%
filter(Population != "CT") %>%
filter(Population != "NR")
All_Surv <- rbind(WIC_Surv, NIN_Surv, RWU_Surv)
Surv_2023 <- rbind(WIC_Surv, NIN_Surv)
SurvPop <- survreg(Surv(Age, Status) ~ Population, data = All_Surv, dist = "weibull")
summary(SurvPop)
SurvSite <- survreg(Surv(Age, Status) ~ Site, data = All_Surv, dist = "weibull")
summary(SurvSite)
SurvPopandSite <- survreg(Surv(Age, Status) ~ Population+Site, data = All_Surv, dist = "weibull")
SurvPopxSite <- survreg(Surv(Age, Status) ~ Population*Site, data = All_Surv, dist = "weibull")
summary(SurvPopxSite)
fitted_values <- SurvPopxSite$linear.predictors
resids <- (log(SurvPopxSite$y[, 1]) - fitted_values) / SurvPopxSite$scale
resKM <- survfit(Surv(resids, Status) ~ 1, data = All_Surv)
plot(resKM, mark.time = FALSE, xlab = "AFT Residuals", ylab = "Survival Probability")
xx <- seq(min(resids), max(resids), length.out = 35)
yy <- exp(- exp(xx))
lines(xx, yy, col = "red", lwd = 2)
legend("bottomleft", c("KM estimate", "95% CI KM estimate",
"Survival function of Extreme Value distribution"),
lty = c(1,2,1), col = c(1,1,2), bty = "n")
p <- predict(SurvPopxSite, type = "response")
with(All_Surv, pam.censor(Age, p, Status))
SurvPopandSite2023 <- survreg(Surv(Age, Status) ~ Population+Site, data = Surv_2023, dist = "weibull")
SurvPopxSite2023 <- survreg(Surv(Age, Status) ~ Population*Site, data = Surv_2023, dist = "weibull")
p <- predict(SurvPopxSite2023, type = "response")
with(Surv_2023, pam.censor(Age, p, Status))
summary(SurvPopxSite2023)
WIC_Surv <- read.csv("WIC_Survival.csv")
NIN_Surv <- read.csv("NIN_Survival.csv")
RWU_Surv <- read.csv("RWU_Survival.csv") %>%
filter(Population != "CT") %>%
filter(Population != "NR")
All_Surv <- rbind(WIC_Surv, NIN_Surv, RWU_Surv)
Surv_2023 <- rbind(WIC_Surv, NIN_Surv)
SurvPop <- survreg(Surv(Age, Status) ~ Population, data = All_Surv, dist = "weibull")
summary(SurvPop)
SurvSite <- survreg(Surv(Age, Status) ~ Site, data = All_Surv, dist = "weibull")
summary(SurvSite)
SurvPopandSite <- survreg(Surv(Age, Status) ~ Population+Site, data = All_Surv, dist = "weibull")
SurvPopxSite <- survreg(Surv(Age, Status) ~ Population*Site, data = All_Surv, dist = "weibull")
summary(SurvPopxSite)
fitted_values <- SurvPopxSite$linear.predictors
resids <- (log(SurvPopxSite$y[, 1]) - fitted_values) / SurvPopxSite$scale
resKM <- survfit(Surv(resids, Status) ~ 1, data = All_Surv)
plot(resKM, mark.time = FALSE, xlab = "AFT Residuals", ylab = "Survival Probability")
xx <- seq(min(resids), max(resids), length.out = 35)
yy <- exp(- exp(xx))
lines(xx, yy, col = "red", lwd = 2)
legend("bottomleft", c("KM estimate", "95% CI KM estimate",
"Survival function of Extreme Value distribution"),
lty = c(1,2,1), col = c(1,1,2), bty = "n")
p <- predict(SurvPopxSite, type = "response")
with(All_Surv, pam.censor(Age, p, Status))
SurvPop <- survreg(Surv(Age, Status) ~ Population, data = All_Surv, dist = "weibull")
summary(SurvPop)
SurvSite <- survreg(Surv(Age, Status) ~ Site, data = All_Surv, dist = "weibull")
summary(SurvSite)
SurvPopandSite <- survreg(Surv(Age, Status) ~ Population+Site, data = All_Surv, dist = "weibull")
SurvPopxSite <- survreg(Surv(Age, Status) ~ Population*Site, data = All_Surv, dist = "weibull")
summary(SurvPopxSite)
#fitted_values <- SurvPopxSite$linear.predictors
#resids <- (log(SurvPopxSite$y[, 1]) - fitted_values) / SurvPopxSite$scale
#resKM <- survfit(Surv(resids, Status) ~ 1, data = All_Surv)
#plot(resKM, mark.time = FALSE, xlab = "AFT Residuals", ylab = "Survival Probability")
#xx <- seq(min(resids), max(resids), length.out = 35)
#yy <- exp(- exp(xx))
#lines(xx, yy, col = "red", lwd = 2)
#legend("bottomleft", c("KM estimate", "95% CI KM estimate",
#    "Survival function of Extreme Value distribution"),
#    lty = c(1,2,1), col = c(1,1,2), bty = "n")
#p <- predict(SurvPopxSite, type = "response")
#with(All_Surv, pam.censor(Age, p, Status))
SurvPopandSite2023 <- survreg(Surv(Age, Status) ~ Population+Site, data = Surv_2023, dist = "weibull")
SurvPopxSite2023 <- survreg(Surv(Age, Status) ~ Population*Site, data = Surv_2023, dist = "weibull")
#p <- predict(SurvPopxSite2023, type = "response")
#with(Surv_2023, pam.censor(Age, p, Status))
summary(SurvPopxSite2023)
WIC_Surv <- read.csv("WIC_Survival.csv")
NIN_Surv <- read.csv("NIN_Survival.csv")
Y1_Surv <- read.csv("RWU_Survival.csv")
RWU_Surv <- Y1_Surv %>%
filter(Population != "CT") %>%
filter(Population != "NR")
All_Surv <- rbind(WIC_Surv, NIN_Surv, RWU_Surv)
Surv_2023 <- rbind(WIC_Surv, NIN_Surv)
Surv2022 <- survreg(Surv(Age, Status) ~ Population+Site, data = Y1_Surv, dist = "weibull")
Surv2022 <- survreg(Surv(Age, Status) ~ Population, data = Y1_Surv, dist = "weibull")
Surv2022 <- survreg(Surv(Age, Status) ~ Population, data = Y1_Surv, dist = "weibull")
summary(Surv2022)
Surv2022 <- survreg(Surv(Age, Status) ~ Population, data = Y1_Surv, dist = "weibull")
summary(Surv2022)
Y1_data <- data.frame(Population = c("CL1","CL2","CT","GH","MV","NR"))
t1 <- predict(Surv2022, type = "quantile", p = 1 - surv, newdata = Y1_data)
Surv2022 <- survreg(Surv(Age, Status) ~ Population, data = Y1_Surv, dist = "weibull")
summary(Surv2022)
Y1_data <- data.frame(Population = c("CL1","CL2","CT","GH","MV","NR"))
surv <- seq(.99, .01, by = -.01)
t1 <- predict(Surv2022, type = "quantile", p = 1 - surv, newdata = Y1_data)
Surv2022 <- survreg(Surv(Age, Status) ~ Population, data = Y1_Surv, dist = "weibull")
summary(Surv2022)
Y1_data <- data.frame(Population = c("CL1","CL2","CT","GH","MV","NR"))
surv <- seq(.99, .01, by = -.01)
t1 <- predict(Surv2022, type = "quantile", p = 1 - surv, newdata = Y1_data)
oys_wbmod <- cbind(Y1_data, t1) %>%
pivot_longer(names_to = "surv_id", values_to = "time", cols = -c(1:2)) %>%
mutate(
surv_id = as.factor(as.numeric(surv_id))) %>%
data.frame()
#oys_wbmod$surv = surv[as.numeric(oys_wbmod$surv_id)]
#oys_wbmod$upper = NA
#oys_wbmod$lower = NA
#oys_wbmod$std.err = NA
#oys_wbmod$strata = NA
#oys_wbmod[, c("upper", "lower", "std.err", "strata")] <- NA
#Plotting probability of survival
ggsurvplot_df(oys_wbmod, surv.geom = geom_line,
color = "Lineage", legend.title = NULL, legend = c("right"), title = "Survival Time")
library(tidyverse)
library(dplyr)
library(dunn.test)
library(ggplot2)
library(cowplot)
library(survival)
library(PAmeasures)
library(survminer)
Surv2022 <- survreg(Surv(Age, Status) ~ Population, data = Y1_Surv, dist = "weibull")
summary(Surv2022)
Y1_data <- data.frame(Population = c("CL1","CL2","CT","GH","MV","NR"))
surv <- seq(.99, .01, by = -.01)
t1 <- predict(Surv2022, type = "quantile", p = 1 - surv, newdata = Y1_data)
oys_wbmod <- cbind(Y1_data, t1) %>%
pivot_longer(names_to = "surv_id", values_to = "time", cols = -c(1:2)) %>%
mutate(
surv_id = as.factor(as.numeric(surv_id))) %>%
data.frame()
#oys_wbmod$surv = surv[as.numeric(oys_wbmod$surv_id)]
#oys_wbmod$upper = NA
#oys_wbmod$lower = NA
#oys_wbmod$std.err = NA
#oys_wbmod$strata = NA
#oys_wbmod[, c("upper", "lower", "std.err", "strata")] <- NA
#Plotting probability of survival
ggsurvplot_df(oys_wbmod, surv.geom = geom_line,
color = "Lineage", legend.title = NULL, legend = c("right"), title = "Survival Time")
Surv2022 <- survreg(Surv(Age, Status) ~ Population, data = Y1_Surv, dist = "weibull")
summary(Surv2022)
Y1_data <- data.frame(Population = c("CL1","CL2","CT","GH","MV","NR"))
surv <- seq(.99, .01, by = -.01)
t1 <- predict(Surv2022, type = "quantile", p = 1 - surv, newdata = Y1_data)
oys_wbmod <- cbind(Y1_data, t1) %>%
pivot_longer(names_to = "surv_id", values_to = "time", cols = -c(1:2)) %>%
mutate(
surv_id = as.factor(as.numeric(surv_id))) %>%
data.frame()
#oys_wbmod$surv = surv[as.numeric(oys_wbmod$surv_id)]
#oys_wbmod$upper = NA
#oys_wbmod$lower = NA
#oys_wbmod$std.err = NA
#oys_wbmod$strata = NA
#oys_wbmod[, c("upper", "lower", "std.err", "strata")] <- NA
#Plotting probability of survival
ggsurvplot_df(oys_wbmod, surv.geom = geom_line,
color = "Population", legend.title = NULL, legend = c("right"), title = "Survival Time")
Surv2022 <- survreg(Surv(Age, Status) ~ Population, data = Y1_Surv, dist = "weibull")
summary(Surv2022)
Y1_data <- data.frame(Population = c("CL1","CL2","CT","GH","MV","NR"))
surv <- seq(.99, .01, by = -.01)
t1 <- predict(Surv2022, type = "quantile", p = 1 - surv, newdata = Y1_data)
oys_wbmod <- cbind(Y1_data, t1) %>%
pivot_longer(names_to = "surv_id", values_to = "time", cols = -c(1:2)) %>%
mutate(
surv_id = as.factor(as.numeric(surv_id))) %>%
data.frame()
oys_wbmod$surv = surv[as.numeric(oys_wbmod$surv_id)]
oys_wbmod$upper = NA
oys_wbmod$lower = NA
oys_wbmod$std.err = NA
oys_wbmod$strata = NA
oys_wbmod[, c("upper", "lower", "std.err", "strata")] <- NA
Plotting probability of survival
Surv2022 <- survreg(Surv(Age, Status) ~ Population, data = Y1_Surv, dist = "weibull")
summary(Surv2022)
Y1_data <- data.frame(Population = c("CL1","CL2","CT","GH","MV","NR"))
surv <- seq(.99, .01, by = -.01)
t1 <- predict(Surv2022, type = "quantile", p = 1 - surv, newdata = Y1_data)
oys_wbmod <- cbind(Y1_data, t1) %>%
pivot_longer(names_to = "surv_id", values_to = "time", cols = -c(1:2)) %>%
mutate(
surv_id = as.factor(as.numeric(surv_id))) %>%
data.frame()
oys_wbmod$surv = surv[as.numeric(oys_wbmod$surv_id)]
oys_wbmod$upper = NA
oys_wbmod$lower = NA
oys_wbmod$std.err = NA
oys_wbmod$strata = NA
oys_wbmod[, c("upper", "lower", "std.err", "strata")] <- NA
#Plotting probability of survival
ggsurvplot_df(oys_wbmod, surv.geom = geom_line,
color = "Population", legend.title = NULL, legend = c("right"), title = "Survival Time")
View(oys_wbmod)
ggsurvplot_df(oys_wbmod, surv.geom = geom_line,
color = "Population", legend.title = NULL, legend = c("right"), title = "Survival Time")
summary(Surv2022)
View(Surv2022)
View(oys_wbmod)
summary(oys_wbmod)
summarize(oys_wbmod)
summarize(oys_wbmod, by = Population)
oys_wbmod %>% group_by(Population) %>% summarize(mean = mean(time))
library(dunn.test)
View(t1)
oys_wbmod %>% group_by(Population) %>% summarize(mean = median(time))
Surv2022 <- survreg(Surv(Age, Status) ~ Population, data = Y1_Surv, dist = "weibull")
summary(Surv2022)
Y1_data <- data.frame(Population = c("CL1","CL2","CT","GH","MV","NR"))
surv <- seq(.99, .01, by = -.01)
t1 <- predict(Surv2022, type = "quantile", p = 1 - surv, newdata = Y1_data)
oys_wbmod <- cbind(Y1_data, t1) %>%
pivot_longer(names_to = "surv_id", values_to = "time", cols = -c(1:2)) %>%
mutate(
surv_id = as.factor(as.numeric(surv_id))) %>%
data.frame()
oys_wbmod$surv = surv[as.numeric(oys_wbmod$surv_id)]
oys_wbmod$upper = NA
oys_wbmod$lower = NA
oys_wbmod$std.err = NA
oys_wbmod$strata = NA
oys_wbmod[, c("upper", "lower", "std.err", "strata")] <- NA
#Plotting probability of survival
ggsurvplot_df(oys_wbmod, surv.geom = geom_line,
color = "Population", legend.title = NULL, legend = c("right"), title = "Survival Time",
break.time.by = 1)
Surv2022 <- survreg(Surv(Age, Status) ~ Population, data = Y1_Surv, dist = "weibull")
summary(Surv2022)
Y1_data <- data.frame(Population = c("CL1","CL2","CT","GH","MV","NR"))
surv <- seq(.99, .01, by = -.01)
t1 <- predict(Surv2022, type = "quantile", p = 1 - surv, newdata = Y1_data)
oys_wbmod <- cbind(Y1_data, t1) %>%
pivot_longer(names_to = "surv_id", values_to = "time", cols = -c(1:2)) %>%
mutate(
surv_id = as.factor(as.numeric(surv_id))) %>%
data.frame()
oys_wbmod$surv = surv[as.numeric(oys_wbmod$surv_id)]
oys_wbmod$upper = NA
oys_wbmod$lower = NA
oys_wbmod$std.err = NA
oys_wbmod$strata = NA
oys_wbmod[, c("upper", "lower", "std.err", "strata")] <- NA
#Plotting probability of survival
ggsurvplot_df(oys_wbmod, surv.geom = geom_line,
color = "Population", legend.title = NULL, legend = c("right"), title = "Survival Time",
break.time.by = 1)
ggsurvplot_df(oys_wbmod, surv.geom = geom_line,
+               color = "Population", legend.title = NULL, legend = c("right"), title = "Survival Time",
ggsurvplot_df(oys_wbmod, surv.geom = geom_line,
color = "Population", legend.title = NULL, legend = c("right"), title = "Survival Time",
break.time.by = 1)
Surv2022 <- survreg(Surv(Age, Status) ~ Population, data = Y1_Surv, dist = "weibull")
summary(Surv2022)
Y1_data <- data.frame(Population = c("CL1","CL2","CT","GH","MV","NR"))
surv <- seq(.99, .01, by = -.01)
t1 <- predict(Surv2022, type = "quantile", p = 1 - surv, newdata = Y1_data)
Y1_wbmod <- cbind(Y1_data, t1) %>%
pivot_longer(names_to = "surv_id", values_to = "time", cols = -c(1:2)) %>%
mutate(
surv_id = as.factor(as.numeric(surv_id))) %>%
data.frame()
Y1_wbmod$surv = surv[as.numeric(Y1_wbmod$surv_id)]
Y1_wbmod$upper = NA
Y1_wbmod$lower = NA
Y1_wbmod$std.err = NA
Y1_wbmod$strata = NA
Y1_wbmod[, c("upper", "lower", "std.err", "strata")] <- NA
#Plotting probability of survival
ggsurvplot_df(Y1_wbmod, surv.geom = geom_line,
color = "Population", legend.title = NULL, legend = c("right"), title = "Survival Time",
break.time.by = 1)
SurvPopxSite2023 <- survreg(Surv(Age, Status) ~ Population*Site, data = Surv_2023, dist = "weibull")
Y2_data <- data.frame(Population = c("CL1","CL2","GH","MV"))
surv <- seq(.99, .01, by = -.01)
t1 <- predict(Surv2023, type = "quantile", p = 1 - surv, newdata = Y2_data)
SurvPopxSite2023 <- survreg(Surv(Age, Status) ~ Population*Site, data = Surv_2023, dist = "weibull")
NIN_survmod <- survreg(Surv(Age, Status) ~ Population*Site, data = NIN_Surv, dist = "weibull")
SurvPopxSite2023 <- survreg(Surv(Age, Status) ~ Population*Site, data = Surv_2023, dist = "weibull")
NIN_survmod <- survreg(Surv(Age, Status) ~ Population, data = NIN_Surv, dist = "weibull")
Y2_data <- data.frame(Population = c("CL1","CL2","GH","MV"))
surv <- seq(.99, .01, by = -.01)
t1 <- predict(SurvPopxSite2023, type = "quantile", p = 1 - surv, newdata = NIN_Surv)
NIN_wbmod <- cbind(Y2_data, t1) %>%
pivot_longer(names_to = "surv_id", values_to = "time", cols = -c(1:2)) %>%
mutate(
surv_id = as.factor(as.numeric(surv_id))) %>%
data.frame()
NIN_wbmod$surv = surv[as.numeric(NIN_wbmod$surv_id)]
NIN_wbmod$upper = NA
NIN_wbmod$lower = NA
NIN_wbmod$std.err = NA
NIN_wbmod$strata = NA
NIN_wbmod[, c("upper", "lower", "std.err", "strata")] <- NA
#Plotting probability of survival
ggsurvplot_df(NIN_wbmod, surv.geom = geom_line,
color = "Population", legend.title = NULL, legend = c("right"), title = "Survival Time",
break.time.by = 1)
#p <- predict(SurvPopxSite2023, type = "response")
#with(Surv_2023, pam.censor(Age, p, Status))
summary(SurvPopxSite2023)
SurvPopxSite2023 <- survreg(Surv(Age, Status) ~ Population*Site, data = NIN_Surv, dist = "weibull")
summary(NIN_survmod)
Surv2022 <- survreg(Surv(Age, Status) ~ Population, data = Y1_Surv, dist = "weibull")
summary(Surv2022)
Y1_data <- data.frame(Population = c("CL1","CL2","CT","GH","MV","NR"))
surv <- seq(.99, .01, by = -.01)
t1 <- predict(Surv2022, type = "quantile", p = 1 - surv, newdata = Y1_data)
Y1_wbmod <- cbind(Y1_data, t1) %>%
pivot_longer(names_to = "surv_id", values_to = "time", cols = -c(1:2)) %>%
mutate(
surv_id = as.factor(as.numeric(surv_id))) %>%
data.frame()
Y1_wbmod$surv = surv[as.numeric(Y1_wbmod$surv_id)]
Y1_wbmod$upper = NA
Y1_wbmod$lower = NA
Y1_wbmod$std.err = NA
Y1_wbmod$strata = NA
Y1_wbmod[, c("upper", "lower", "std.err", "strata")] <- NA
#Plotting probability of survival
ggsurvplot_df(Y1_wbmod, surv.geom = geom_line,
color = "Population", legend.title = NULL, legend = c("right"), title = "Survival Time",
break.time.by = 1)
SurvPopxSite2023 <- survreg(Surv(Age, Status) ~ Population*Site, data = Surv_2023, dist = "weibull")
NIN_survmod <- survreg(Surv(Age, Status) ~ Population, data = NIN_Surv, dist = "weibull")
WIC_survmod <- survreg(Surv(Age, Status) ~ Population, data = WIC_Surv, dist = "weibull")
Y2_data <- data.frame(Population = c("CL1","CL2","GH","MV"))
surv <- seq(.99, .01, by = -.01)
t1 <- predict(SurvPopxSite2023, type = "quantile", p = 1 - surv, newdata = NIN_Surv)
summary(SurvPopxSite2023)
summary(WIC_survmod)
PopandSite2023 <- lm(log(Length) ~ Site+Population, data = Data_2023)
PopxSite2023 <- lm(log(Length) ~ Site*Population, data = Data_2023)
summary(PopxSite2023)
anova(PopandSite2023, PopxSite2023)
PopandSite2023 <- lm(log(Length) ~ Site+Population, data = Data_2023)
PopxSite2023 <- lm(log(Length) ~ Site*Population, data = Data_2023)
summary(PopxSite2023)
anova(PopandSite2023, PopxSite2023)
PopandSite <- lm(log(Length) ~ Site+Population, data = All_data)
PopxSite <- lm(log(Length) ~ Site*Population, data = All_data)
summary(PopxSite)
anova(PopandSite, PopxSite)
summary(PopandSite2023)
summary(lm(log(Length) ~ Site, data = Data_2023))
t.test(log(Length), Site, data = Data_2023)
t.test(log(Length) ~ Site, data = Data_2023)
NIN_Size %>% group_by(Line) %>% summarize(mean = mean(Length))
library(tidyverse)
NIN_Size %>% group_by(Line) %>% summarize(mean = mean(Length))
WIC_Size %>% group_by(Line) %>% summarize(mean = mean(Length))
t.test(Length ~ Site, data = Data_2023)
CL1 <- Data_2023 %>% filter(Line == CL1)
CL1 <- Data_2023 %>% filter(Population == CL1)
CL1 <- Data_2023 %>% filter(Population == "CL1")
t.test(Length ~ Site, data = CL1)
CL2 <- Data_2023 %>% filter(Population == "CL2")
t.test(Length ~ Site, data = CL2)
rm(CL1)
rm(CL2)
1Pop <- Data_2023 %>% filter(Population == "MV")
Pop1 <- Data_2023 %>% filter(Population == "MV")
t.test(Length ~ Site, data = Pop1)
wilcoxon.test(Length, Site, data=Data_2023)
wilcox.test(Length, Site, data=Data_2023)
wilcox.test(Length, Site, Data_2023)
wilcox.test(Length ~ Site, Data_2023)
wilcox.test(Length ~ Site, Pop1)
View(Pop1)
Pop1 <- Data_2023 %>% filter(Population == "CL1")
wilcox.test(Length ~ Site, Pop1)
Pop1 <- Data_2023 %>% filter(Population == "CL2")
wilcox.test(Length ~ Site, Pop1)
rm(Pop1)
shapiro.test(All_data$Length)
kruskal.test(All_data$Length ~ All_data$Population)
dunn.test(All_data$Length, g = All_data$Population, method  = "bonferroni")
library(dunn.test)
dunn.test(Length, Population, data = NIN_Size)
dunn.test(Length, Population, data = NIN_Size, method = "bonferroni")
dunn.test(NIN_Size$Length, NIN_Size$Population, method = "bonferroni")
dunn.test(NIN_Size$Length, g = NIN_Size$Population, method = "bonferroni")
dunn.test(NIN_Size$Length, g = NIN_Size$Line, method = "bonferroni")
dunn.test(NIN_Size$Length, g = WIC_Size$Line, method = "bonferroni")
dunn.test(WIC_Size$Length, g = WIC_Size$Line, method = "bonferroni")
WIC_yield <- merge(WIC_Survival, WIC_End) %>%
mutate(Yield = Percent.Survival*End_Size*5)
library(tidyverse)
WIC_yield <- merge(WIC_Survival, WIC_End) %>%
mutate(Yield = Percent.Survival*End_Size*5)
WIC_Survival <- read.csv("WIC_Survival.csv")
WIC_End <- read.csv("WIC_End.csv")
NIN_Survival <- read.csv("NIN_Survival.csv")
NIN_End <- read.csv("NIN_End.csv")
RWU_Survival <- read.csv("RWU_Survival.csv")
RWU_End <- read.csv("RWU_End.csv")
WIC_Survival <- read.csv("WIC_Survival.csv")
WIC_End <- read.csv("WIC_End.csv")
NIN_Survival <- read.csv("NIN_Survival.csv")
NIN_End <- read.csv("NIN_End.csv")
RWU_Survival <- read.csv("RWU_Survival.csv")
RWU_End <- read.csv("RWU_End.csv")
WIC_yield <- merge(WIC_Survival, WIC_End) %>%
mutate(Yield = Percent.Survival*End_Size*5)
library(tidyverse)
WIC_Survival <- read.csv("WIC_Survival.csv")
WIC_End <- read.csv("WIC_End.csv")
NIN_Survival <- read.csv("NIN_Survival.csv")
NIN_End <- read.csv("NIN_End.csv")
RWU_Survival <- read.csv("RWU_Survival.csv")
RWU_End <- read.csv("RWU_End.csv")
WIC_yield <- merge(WIC_Survival, WIC_End) %>%
mutate(Yield = Percent.Survival*End_Size*5)
View(WIC_Survival)
View(WIC_Surv)
View(WIC_Survival)
